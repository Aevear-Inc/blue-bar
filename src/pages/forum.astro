
<link rel="preconnect" href="https://www.google.com">
<link rel="preconnect" href="https://www.gstatic.com" crossorigin>
<!-- Forum Page Content -->
<h1>Welcome to the Forum</h1>

<!-- Email Form -->
<form id="emailForm">
    <label for="email">Your Email:</label>
    <input type="email" id="email" name="email" required />

    <label for="message">Message:</label>
    <textarea id="message" name="message" required></textarea>
    <button type="submit">Send Email</button>
</form>
<script async src="https://www.google.com/recaptcha/api.js"></script>

<script is:inline>
    const form = document.getElementById('emailForm');
    if (form) {
        form.addEventListener('submit', async (event) => {
            event.preventDefault();

            grecaptcha.ready(function() {
                grecaptcha.execute('6LfZyiQpAAAAADMUcrc0gtIidH-ayxwv2dzAKWXW', {action: 'submit'}).then(function(token) {
                    // Add your logic to submit to your server here
                    

const email =  document.getElementById('email').value;
const message = document.getElementById('message').value;
const recaptcha = token
fetch('/.netlify/functions/sendEmail', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
    },
    body: JSON.stringify({ email, message, recaptcha }),
})

                    .then(response => response.json())
                    .then(data => {
                        alert(data.message);
                    })
                    .catch(error => {
                        console.error('Error:', error);
                    });
                });
            });
        });
    }
</script>

<!-- Load Google reCAPTCHA v3 script -->
<script async src="https://www.google.com/recaptcha/api.js?render=6LfZyiQpAAAAADMUcrc0gtIidH-ayxwv2dzAKWXW"></script>